# Excel数据可视化分析工具

## 📋 项目概述

这是一个基于Streamlit的Excel数据可视化分析工具的模块化版本，具有智能文件读取、多种图表类型、AI数据分析等功能。

## 🏗️ 项目结构

```
|
├── main_streamlit.py         # 模块化主文件
├── config.py                 # 配置文件
├── file_handler.py           # 文件处理模块
├── ai_chat.py                # AI聊天模块
├── chart_generator.py        # 图表生成模块
├── ui_components.py          # UI组件模块
├── requirements.txt          # 依赖包列表
└── README.md                 # 项目说明文档
```

## 📦 模块说明

### 1. config.py
- 应用程序配置
- 颜色方案定义
- 文件处理参数
- API配置
- 图表配置

### 2. file_handler.py
- `FileHandler`: 智能文件读取类
- `DataValidator`: 数据验证类
- `TimeColumnDetector`: 时间列检测类
- `IndexSetter`: 索引设置类
- `DataCleaner`: 数据清洗类

### 3. ai_chat.py
- `AIChat`: AI聊天功能类
- `LLMProvider`: LLM提供商管理类
- 支持LangChain + DeepSeek、DeepSeek API、基础数据查询

### 4. chart_generator.py
- `ChartGenerator`: 图表生成器类
- `ZoomController`: 缩放控制器类
- 支持单轴、双轴、三轴、子图表等多种布局

### 5. ui_components.py
- `UIComponents`: UI组件类
- `SessionManager`: 会话管理器类
- 统一的界面组件创建和管理

## 🚀 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 运行应用

**推荐使用模块化版本：**
```bash
streamlit run main_streamlit_modular.py
```

**或使用原始版本：**
```bash
streamlit run main_streamlit.py
```

### 3. 访问应用

在浏览器中打开显示的本地URL（通常是 http://localhost:8501）

## ✨ 功能特点

### 📁 智能文件处理
- 自动编码检测
- 支持Excel (.xlsx, .xls) 和 CSV 格式
- 智能时间列检测
- 灵活的索引设置
- 数据验证和清洗

### 📊 多样化图表
- **单轴图表**: 折线图、柱状图、散点图
- **双轴图表**: 不同量级数据的对比显示
- **三轴图表**: 复杂数据的多维度展示
- **子图表**: 网格布局的多图表显示
- **紧凑子图**: 垂直堆叠的紧凑显示
- **图表导出**: 支持导出为 HTML 文件和 GIF 动图

### 🎨 交互式功能
- 图表缩放控制
- 实时数据预览
- 动态列选择
- 轴分配管理

### 🤖 AI数据分析
- **DeepSeek API**: 直接API调用，支持智能分析工具选择

#### 新增分析功能
- **统计分析**: 描述性统计、数据概览
- **相关性分析**: 变量间相关性计算和强相关性识别
- **异常值检测**: IQR方法检测数据异常值
- **趋势分析**: 线性趋势检测和显著性检验
- **分布分析**: 偏度、峰度、正态性检验
- **智能洞察**: 自动生成数据洞察和建议

### 🔧 数据清洗
- 重复行移除
- 缺失值处理（删除、填充等）
- 数据类型转换

## 🔧 配置说明

### API配置

1. 在侧边栏选择模型提供商
2. 输入DeepSeek API密钥（如需AI功能）
3. 选择合适的分析模式

### 文件处理配置

- **标题行位置**: 指定哪一行作为列标题
- **跳过行数**: 从文件开头跳过的行数
- **编码检测**: 自动检测文件编码

## 📈 性能优化

### 模块化优势

1. **代码组织**: 功能模块化，易于维护
2. **性能提升**: 减少重复文件读取
3. **可扩展性**: 模块化设计便于功能扩展
4. **可测试性**: 独立模块便于单元测试

### 文件读取优化

- 一次性编码检测和数据读取
- 智能缓存机制
- 内存优化的数据处理

### GIF导出优化
- **智能帧数调整**: 根据数据量动态调整GIF的帧数和每帧持续时间，优化生成速度和文件大小。
- **分辨率和缩放控制**: 降低导出PNG图像的分辨率和缩放比例，进一步减小GIF文件体积。
- **进度提示**: 在生成GIF过程中提供进度条和状态文本，提升用户体验。

## 🐛 问题反馈

如遇到问题，请通过以下方式反馈：
- 邮箱:kangy_wang@hnair.com
- 在代码中查看具体错误信息
- 检查依赖包是否正确安装

## 📝 更新日志

### v2.2.0 (功能增强与优化)
- ✅ 新增自定义轴配置功能，支持灵活的X轴和Y轴数据选择，以及多列数据对比。
- ✅ 异常处理优化，提升了应用稳定性，处理文件读取、图表生成等异常情况。

### v2.1.0 (功能增强与优化)
- ✅ 新增动图导出功能，并对生成过程进行优化，包括智能帧数调整、分辨率控制和进度提示。
- ✅ 为非哈希列图表添加了始终可见的文本标注功能。

### v2.0.0 (模块化版本)
- ✅ 完全模块化重构
- ✅ 性能优化
- ✅ 增强的错误处理
- ✅ 改进的用户界面
- ✅ 更好的代码组织
- ✅ AI聊天功能

### v1.0.0 (原始版本)
- ✅ 基础功能实现
- ✅ 文件上传和处理
- ✅ 图表生成


**更新时间**: 2025年6月20日
